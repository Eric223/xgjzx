function register(i){function n(){m=!0;for(var i in u)0==u[i]&&(m=!1);m?f.removeClass("btn-disable"):f.addClass("btn-disable")}function t(){var i=$(this).val().textFilter(),t=i.length;$(this).val(i),u.name=!1,0==t?$(this).hint("warn","不能为空"):t>10?$(this).hint("warn","不能超过10个字符"):($(this).hint("tick",""),u.name=!0,d.user.name=i),n()}function e(){var i=$(this).val(),t=i.length;if(u.password=!1,0==t)$(this).hint("warn","不能为空");else if(t<8)$(this).hint("warn","至少8位英文加数字");else{var e=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,}$/;if(e.exec(i)){$(this).hint("tick","");var s=md5(i);$(this).hint("tick",""),u.password=!0,d.user.password=s}else $(this).hint("warn","至少8位英文加数字")}n()}function s(){w=!w,w?($(this).removeClass("form-icon-eyeClose"),l.hide(),c.show()):($(this).addClass("form-icon-eyeClose"),l.show(),c.hide())}function a(){var i=$(this).val();c.val(i)}function r(){var i=$(this).val();l.val(i)}function o(){var i=$(this).val(),t=i.length,e=$(this);if(u.email=!1,0==t)$(this).hint("warn","不能为空");else{/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.exec(i)?(e.hint("loading","检验中..."),myAjax(api.checkEmail,"email="+i,function(t){console.log(t),100==t?(e.hint("tick",""),u.email=!0,d.user.email=i,n()):101==t&&e.hint("warn","此邮箱已经注册")})):$(this).hint("warn","格式错误")}n()}function h(){return m&&myAjax(api.signIn,JSON.stringify(d),function(i){if("100"==i.result){myAlert("注册成功，请到邮箱激活");setTimeout(function(){window.location.href="/pages/login.html"},2e3)}else"101"==i.result&&myAlert("网络错误")}),!1}var l=i.find("#password"),c=(i.find("#company"),i.find("#passwordOpen")),f=(i.find("#btnSendCode"),i.find("#btnRegister")),d=($(".alert"),{user:{name:"",password:"",phone:"",email:""},code:""}),u={name:!1,password:!1,email:!1},m=!0;i.on("blur","#name",t).on("blur","#password, #passwordOpen",e).on("change","#password",a).on("change","#passwordOpen",r).on("click","#icon-eye",s).on("blur","#email",o).on("click","#btnRegister",h),jQuery.fn.hint=function(i,n){var t="";switch(i){case"tick":t=".form-icon-tick";break;case"warn":t=".form-icon-warn";break;case"loading":t=".form-icon-loading";break;default:return}this.parent().find(t).show().siblings("i").hide(),this.parent().find("b").text(n)},jQuery.fn.tick=function(){this.parent().find(".form-icon-tick").show().siblings("i").hide(),this.parent().find("b").text("")},jQuery.fn.warn=function(i){this.parent().find(".form-icon-warn").show().siblings("i").hide(),this.parent().find("b").text(i)},jQuery.fn.loading=function(i){this.parent().find(".form-icon-loading").show().siblings("i").hide(),this.parent().find("b").text(i)};var w=!1}String.prototype.textFilter=function(){for(var i=new RegExp("[`~%!@#^=''?~！@#￥……&——‘”“'？*()（），,。.、+-/:：${}<>《》]"),n="",t=0;t<this.length;t++)n+=this.substr(t,1).replace(i,"");return n},$(function(){register($("#form"))});