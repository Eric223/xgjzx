function loadMap(e,n,t){var r=new BMap.Map("containMap");r.centerAndZoom(n,12),r.addControl(new BMap.NavigationControl),r.enableScrollWheelZoom();var a=new BMap.BusLineSearch(n,{renderOptions:{map:r,panel:"r-result"},onGetBusListComplete:function(e){if(e){var n=e.getBusListItem(1);a.getBusLine(n)}}});a.getBusList(t),e.find("span").text(t)}function urlSearchToObj(){var e=window.location.search,n={city:"不限",level:"",route:""};if(e.indexOf("?")>=0){e.split("?")[1].split("&").forEach(function(e,t){var r=e.split("=")[0],a=e.split("=")[1];for(var i in n)r==i&&(n[i]="city"==i||"route"==i?decodeURI(a):a)})}return n}function getData(e,n){var t=e;t.level=function(e){switch(e){case"S":return 1;case"A++":return 2;case"A+":return 3;case"A":return 4;default:return""}}(e.level),myAjax(api.getBusPriceTable,t,function(e){n&&n(e)})}function renderLevelImg(e,n){e.find(".example").attr({src:"../img/search_detail/level_"+n+".jpg"})}function renderTable(e,n){var t=0;for(var r in n){for(var a=2-t,i=e.find("tbody tr").eq(a),o=0;o<n[r].length;o++)i.find("td").eq(o+1).text(n[r][o]);t++}}function renderInfo(e,n){var t=e.find("strong");t.eq(0).find("span").text(n.city),t.eq(1).find("span").text(n.route),t.eq(2).find("span").text(n.level)}$(function(){var e=urlSearchToObj();renderLevelImg($(".left"),e.level),getData(e,function(e){renderTable($("#busPriceTab"),e)}),loadMap($(".map-header"),e.city,e.route),renderInfo($(".price"),e)});